alter table artikel drop constraint FKD458EA2C99F20D47;
alter table auffuehrung drop constraint FK66B638A019C5BD90;
alter table auffuehrung drop constraint FK66B638A099F20D47;
alter table belegung drop constraint FK6113CE2333DC0AB9;
alter table belegung drop constraint FK6113CE23676BD042;
alter table bestellung drop constraint FK5815590D43D4A1A8;
alter table bestellung drop constraint FK5815590D775FA73A;
alter table engagement drop constraint FKA2BC583FD5DA29EC;
alter table engagement drop constraint FKA2BC583FAE76E113;
alter table kategorie drop constraint FKFF78593F19C5BD90;
alter table kunde drop constraint FK61AABC587316983;
alter table mitarbeiter drop constraint FK5E55DFA487316983;
alter table reihe drop constraint FK675F813B7D00ACA;
alter table saal drop constraint FK35BEF978CA5906;
alter table ticketcard drop constraint FK7C92801C25417FE1;
alter table transaktion drop constraint FK80118EE6FB437F50;
alter table transaktion drop constraint FK80118EE618C8D52A;
alter table transaktion drop constraint FK80118EE625417FE1;
alter table transaktion drop constraint FK80118EE643D4A1A8;
alter table transaktion drop constraint FK80118EE65E1C6830;
drop table artikel if exists;
drop table auffuehrung if exists;
drop table belegung if exists;
drop table bestellung if exists;
drop table engagement if exists;
drop table kategorie if exists;
drop table kuenstler if exists;
drop table kunde if exists;
drop table mitarbeiter if exists;
drop table ort if exists;
drop table reihe if exists;
drop table saal if exists;
drop table ticketcard if exists;
drop table transaktion if exists;
drop table veranstaltung if exists;
create table artikel (artikelnr integer generated by default as identity (start with 1), kurzbezeichnung varchar(30) not null, beschreibung varchar(200), preis numeric not null, kategorie varchar(1) not null, abbildung varchar(100), veranstbez varchar(30), veranstkat varchar(30), primary key (artikelnr));
create table auffuehrung (datumuhrzeit timestamp not null, saalbez varchar(30) not null, ortbez varchar(30) not null, ort varchar(30) not null, storniert bit not null, preis varchar(1) not null, hinweis varchar(200), veranstbez varchar(30), veranstkat varchar(30), primary key (datumuhrzeit, saalbez, ortbez, ort));
create table belegung (reihebez varchar(30) not null, kategoriebez varchar(30) not null, saalbez varchar(30) not null, ortbez varchar(30) not null, ort varchar(30) not null, datumuhrzeit timestamp not null, belegung varchar(255), anzfrei integer not null, anzres integer not null, anzverk integer not null, primary key (reihebez, kategoriebez, saalbez, ortbez, ort, datumuhrzeit));
create table bestellung (datumuhrzeit timestamp not null, artikelnr integer not null, kartennr integer not null, menge integer not null, zahlart varchar(20) not null, primary key (datumuhrzeit, artikelnr, kartennr));
create table engagement (kuenstlernr integer not null, bezeichnung varchar(30) not null, kategorie varchar(30) not null, funktion varchar(30), gage numeric, primary key (kuenstlernr, bezeichnung, kategorie));
create table kategorie (bezeichnung varchar(30) not null, saalbez varchar(30) not null, ortbez varchar(30) not null, ort varchar(30) not null, preismin numeric not null, preisstd numeric not null, preismax numeric not null, primary key (bezeichnung, saalbez, ortbez, ort));
create table kuenstler (kuenstlernr integer generated by default as identity (start with 1), nname varchar(30) not null, vname varchar(30) not null, titel varchar(30), geschlecht varchar(1) not null, geburtsdatum date, biographie varchar(200), primary key (kuenstlernr));
create table kunde (kartennr integer not null, blz varchar(5), kontonr varchar(16), ermaechtigung bit not null, kreditkartennr varchar(16), kkgueltigbis date, kontostand numeric, kontolimit numeric, ermaessigung numeric not null, tkgueltigbis date not null, gesperrt bit not null, onlinepwd varchar(8), gruppe varchar(20) not null, vorlieben varchar(200), primary key (kartennr));
create table mitarbeiter (kartennr integer not null, blz varchar(5) not null, kontonr varchar(16) not null, pin varchar(4) not null, berechtigung varchar(30) not null, passwort varchar(8) not null, username varchar(255), primary key (kartennr), unique (username));
create table ort (bezeichnung varchar(30) not null, ort varchar(30) not null, kategorie varchar(20) not null, strasse varchar(30) not null, plz varchar(4) not null, bundesland varchar(20) not null, telnr varchar(15), besitzer varchar(30), oeffnungszeiten varchar(200), kiosk bit not null, verkaufsstelle bit not null, auffuehrungsort bit not null, primary key (bezeichnung, ort));
create table reihe (bezeichnung varchar(30) not null, kategoriebez varchar(30) not null, saalbez varchar(30) not null, ortbez varchar(30) not null, ort varchar(30) not null, startplatz integer not null, anzplaetze integer not null, sitzplatz bit not null, primary key (bezeichnung, kategoriebez, saalbez, ortbez, ort));
create table saal (bezeichnung varchar(30) not null, ortbez varchar(30) not null, ort varchar(30) not null, typ varchar(30) not null, anzplaetze integer not null, kostenprotag numeric, primary key (bezeichnung, ortbez, ort));
create table ticketcard (kartennr integer generated by default as identity (start with 1), typ varchar(1) not null, nname varchar(30), vname varchar(30), titel varchar(30), geschlecht varchar(1), geburtsdatum date, strasse varchar(30), plz varchar(4), ort varchar(30), telnr varchar(20), email varchar(50), verkaufsstelle varchar(30), verkaufsort varchar(30), primary key (kartennr));
create table transaktion (datumuhrzeit timestamp not null, kundennr integer not null, mitarbeiternr integer not null, verkauft bit not null, storniert bit not null, resnr integer, preis numeric not null, startplatz integer not null, anzplaetze integer not null, zahlart varchar(20), reihebez varchar(30), kategoriebez varchar(30), saalbez varchar(30), ortbez varchar(30), ort varchar(30), auffdatumuhrzeit timestamp, verkaufsstelle varchar(30), verkaufsort varchar(30), kartennr integer, primary key (datumuhrzeit, kundennr, mitarbeiternr), unique (resnr));
create table veranstaltung (bezeichnung varchar(30) not null, kategorie varchar(30) not null, subkategorie varchar(30), jahrerstellung integer, spracheton varchar(30), spracheut varchar(30), dauer integer not null, freigabe varchar(30), abbildung varchar(100), inhalt varchar(200) not null, kritik varchar(200), bewertung varchar(200), hinweis varchar(200), primary key (bezeichnung, kategorie));
alter table artikel add constraint FKD458EA2C99F20D47 foreign key (veranstbez, veranstkat) references veranstaltung;
alter table auffuehrung add constraint FK66B638A019C5BD90 foreign key (saalbez, ortbez, ort) references saal;
alter table auffuehrung add constraint FK66B638A099F20D47 foreign key (veranstbez, veranstkat) references veranstaltung;
alter table belegung add constraint FK6113CE2333DC0AB9 foreign key (datumuhrzeit, saalbez, ortbez, ort) references auffuehrung;
alter table belegung add constraint FK6113CE23676BD042 foreign key (reihebez, kategoriebez, saalbez, ortbez, ort) references reihe;
alter table bestellung add constraint FK5815590D43D4A1A8 foreign key (kartennr) references kunde;
alter table bestellung add constraint FK5815590D775FA73A foreign key (artikelnr) references artikel;
alter table engagement add constraint FKA2BC583FD5DA29EC foreign key (kuenstlernr) references kuenstler;
alter table engagement add constraint FKA2BC583FAE76E113 foreign key (bezeichnung, kategorie) references veranstaltung;
alter table kategorie add constraint FKFF78593F19C5BD90 foreign key (saalbez, ortbez, ort) references saal;
alter table kunde add constraint FK61AABC587316983 foreign key (kartennr) references ticketcard;
alter table mitarbeiter add constraint FK5E55DFA487316983 foreign key (kartennr) references ticketcard;
alter table reihe add constraint FK675F813B7D00ACA foreign key (kategoriebez, saalbez, ortbez, ort) references kategorie;
alter table saal add constraint FK35BEF978CA5906 foreign key (ortbez, ort) references ort;
alter table ticketcard add constraint FK7C92801C25417FE1 foreign key (verkaufsstelle, verkaufsort) references ort;
alter table transaktion add constraint FK80118EE6FB437F50 foreign key (reihebez, kategoriebez, saalbez, ortbez, ort, auffdatumuhrzeit) references belegung;
alter table transaktion add constraint FK80118EE618C8D52A foreign key (mitarbeiternr) references mitarbeiter;
alter table transaktion add constraint FK80118EE625417FE1 foreign key (verkaufsstelle, verkaufsort) references ort;
alter table transaktion add constraint FK80118EE643D4A1A8 foreign key (kartennr) references kunde;
alter table transaktion add constraint FK80118EE65E1C6830 foreign key (kundennr) references kunde;
